var _0x28bc=['log','formatters','request','then','result','catch','errors','handle','finally','response','info','updateRoutine','Updates\x20an\x20existing\x20routine','webSocket','api.validators.routineId','validators','routines','retrieveById','routineId','codes','invalid\x20routine\x20id\x20\x27','name','actions','meta','Delete\x20an\x20existing\x20routine','input','retrieveRoutines','Retrieve\x20all\x20routines','retrieveAll','retrieveRoutine','Retrieve\x20a\x20specific\x20routine','executeRoutine','Executes\x20a\x20specific\x20routine','map','devices','device','invalid\x20device\x20id\x20\x27','deviceTypes','type','find','actionName','invalid\x20action\x20name\x20\x27','\x27\x20for\x20device\x20id\x20\x27','length','invalid\x20number\x20of\x20parameters\x20\x27','\x27\x20for\x20action\x20name\x20\x27','instance','state','getInternalState','toISOString','create','all','filter','forEach','message','warning','push','routine','string','good\x20night','object','turnOff','f597c13717008fb1','armStay','createRoutine','Creates\x20a\x20new\x20routine','Routine','connection','rawConnection','params','body'];(function(_0x354530,_0x4d1a12){var _0xddd115=function(_0x3435b1){while(--_0x3435b1){_0x354530['push'](_0x354530['shift']());}};_0xddd115(++_0x4d1a12);}(_0x28bc,0x155));var _0x3bbc=function(_0x1e00ed,_0x432425){_0x1e00ed=_0x1e00ed-0x0;var _0x516d5a=_0x28bc[_0x1e00ed];return _0x516d5a;};'use strict';const modelSchema={'title':_0x3bbc('0x0'),'required':['name','actions'],'schema':{'name':{'type':_0x3bbc('0x1'),'example':_0x3bbc('0x2')},'actions':{'type':_0x3bbc('0x3'),'example':[{'device':{'id':'c39181d52abe5555'},'actionName':_0x3bbc('0x4'),'params':[],'meta':{}},{'device':{'id':_0x3bbc('0x5')},'actionName':_0x3bbc('0x6'),'params':['1234'],'meta':{}}]},'meta':{'type':_0x3bbc('0x3'),'example':{}}}};exports[_0x3bbc('0x7')]={'name':_0x3bbc('0x7'),'description':_0x3bbc('0x8'),'blockedConnectionTypes':['webSocket'],'version':1.5,'modelSchema':modelSchema,'outputExample':{},'tags':[_0x3bbc('0x9')],'run':function(_0x5d93cd,_0xcafd71,_0x22bde7){var _0x1b3c92=_0xcafd71[_0x3bbc('0xa')][_0x3bbc('0xb')][_0x3bbc('0xc')][_0x3bbc('0xd')];_0x5d93cd[_0x3bbc('0xe')](_0x5d93cd[_0x3bbc('0xf')][_0x3bbc('0x10')](_0x3bbc('0x7'),_0x1b3c92),'info');_0x5d93cd['validators'][_0x3bbc('0x0')](_0x1b3c92)[_0x3bbc('0x11')](_0x4c382d=>{return _0x5d93cd['routines']['create'](_0x4c382d);})[_0x3bbc('0x11')](_0x13d8b3=>{_0xcafd71['response'][_0x3bbc('0x12')]=_0x13d8b3;_0x22bde7();})[_0x3bbc('0x13')](_0x5781d6=>{_0x22bde7(_0x5d93cd[_0x3bbc('0x14')][_0x3bbc('0x15')](_0x5781d6));})[_0x3bbc('0x16')](()=>{_0x5d93cd[_0x3bbc('0xe')](_0x5d93cd[_0x3bbc('0xf')]['response']('createRoutine',_0xcafd71[_0x3bbc('0x17')]),_0x3bbc('0x18'));});}};exports[_0x3bbc('0x19')]={'name':_0x3bbc('0x19'),'description':_0x3bbc('0x1a'),'blockedConnectionTypes':[_0x3bbc('0x1b')],'version':1.5,'modelSchema':modelSchema,'inputs':{'routineId':{'required':!![],'validator':_0x3bbc('0x1c')}},'outputExample':{},'tags':['Routine'],'run':function(_0x2dc6cf,_0x39157c,_0xbb970){var _0x1cb1d2=_0x39157c[_0x3bbc('0xa')][_0x3bbc('0xb')][_0x3bbc('0xc')][_0x3bbc('0xd')];_0x2dc6cf[_0x3bbc('0xe')](_0x2dc6cf[_0x3bbc('0xf')][_0x3bbc('0x10')](_0x3bbc('0x19'),_0x1cb1d2),_0x3bbc('0x18'));var _0x1ea6be={};_0x2dc6cf[_0x3bbc('0x1d')]['routine'](_0x1cb1d2)['then'](_0x15ff16=>{_0x1ea6be[_0x3bbc('0x0')]=_0x15ff16;return _0x2dc6cf[_0x3bbc('0x1e')][_0x3bbc('0x1f')](_0x39157c[_0x3bbc('0xc')][_0x3bbc('0x20')]);})[_0x3bbc('0x11')](_0x4dcdd2=>{if(!_0x4dcdd2)throw{'code':_0x2dc6cf['errors'][_0x3bbc('0x21')]['input'],'description':_0x3bbc('0x22')+_0x39157c[_0x3bbc('0xc')][_0x3bbc('0x20')]+'\x27'};_0x4dcdd2[_0x3bbc('0x23')]=_0x1ea6be[_0x3bbc('0x0')][_0x3bbc('0x23')];_0x4dcdd2[_0x3bbc('0x24')]=_0x1ea6be[_0x3bbc('0x0')]['actions'];_0x4dcdd2[_0x3bbc('0x25')]=_0x1ea6be[_0x3bbc('0x0')][_0x3bbc('0x25')];return _0x2dc6cf[_0x3bbc('0x1e')]['update'](_0x4dcdd2);})['then'](_0x3e4858=>{_0x39157c['response']['result']=_0x3e4858;_0xbb970();})[_0x3bbc('0x13')](_0x51341a=>{_0xbb970(_0x2dc6cf[_0x3bbc('0x14')][_0x3bbc('0x15')](_0x51341a));})[_0x3bbc('0x16')](()=>{_0x2dc6cf[_0x3bbc('0xe')](_0x2dc6cf['formatters'][_0x3bbc('0x17')](_0x3bbc('0x19'),_0x39157c[_0x3bbc('0x17')]),_0x3bbc('0x18'));});}};exports['deleteRoutine']={'name':'deleteRoutine','description':_0x3bbc('0x26'),'blockedConnectionTypes':[_0x3bbc('0x1b')],'version':1.5,'modelSchema':null,'inputs':{'routineId':{'routineId':!![],'validator':_0x3bbc('0x1c')}},'outputExample':{},'tags':[_0x3bbc('0x9')],'run':function(_0x5c3644,_0x461d1c,_0x1a80f9){_0x5c3644[_0x3bbc('0x1e')]['delete'](_0x461d1c['params'][_0x3bbc('0x20')])[_0x3bbc('0x11')](_0x5538db=>{if(!_0x5538db)throw{'code':_0x5c3644[_0x3bbc('0x14')]['codes'][_0x3bbc('0x27')],'description':_0x3bbc('0x22')+_0x461d1c[_0x3bbc('0xc')]['routineId']+'\x27'};_0x461d1c['response'][_0x3bbc('0x12')]=_0x5538db;_0x1a80f9();})[_0x3bbc('0x13')](_0x1e694c=>{_0x1a80f9(_0x5c3644[_0x3bbc('0x14')][_0x3bbc('0x15')](_0x1e694c));})['then'](()=>{_0x5c3644[_0x3bbc('0xe')](_0x5c3644[_0x3bbc('0xf')][_0x3bbc('0x17')]('deleteRoutine',_0x461d1c[_0x3bbc('0x17')]),_0x3bbc('0x18'));});}};exports[_0x3bbc('0x28')]={'name':_0x3bbc('0x28'),'description':_0x3bbc('0x29'),'blockedConnectionTypes':[_0x3bbc('0x1b')],'version':1.5,'modelSchema':null,'outputExample':{},'tags':[_0x3bbc('0x9')],'run':function(_0x58ab5c,_0x2f5d8a,_0x1d89c6){_0x58ab5c[_0x3bbc('0x1e')][_0x3bbc('0x2a')]()[_0x3bbc('0x11')](_0x5db643=>{_0x2f5d8a['response'][_0x3bbc('0x12')]=_0x5db643;_0x1d89c6();})[_0x3bbc('0x13')](_0x46863c=>{_0x1d89c6(_0x58ab5c[_0x3bbc('0x14')][_0x3bbc('0x15')](_0x46863c));})[_0x3bbc('0x11')](()=>{_0x58ab5c[_0x3bbc('0xe')](_0x58ab5c[_0x3bbc('0xf')][_0x3bbc('0x17')]('retrieveRooutines',_0x2f5d8a[_0x3bbc('0x17')]),_0x3bbc('0x18'));});}};exports['retrieveRoutine']={'name':_0x3bbc('0x2b'),'description':_0x3bbc('0x2c'),'blockedConnectionTypes':[_0x3bbc('0x1b')],'version':1.5,'modelSchema':null,'inputs':{'routineId':{'required':!![],'validator':_0x3bbc('0x1c')}},'outputExample':{},'tags':['Routine'],'run':function(_0x1ae3b0,_0x59bc3f,_0x20a672){_0x1ae3b0[_0x3bbc('0x1e')][_0x3bbc('0x1f')](_0x59bc3f[_0x3bbc('0xc')][_0x3bbc('0x20')])[_0x3bbc('0x11')](_0x42c71c=>{if(!_0x42c71c)throw{'code':_0x1ae3b0[_0x3bbc('0x14')][_0x3bbc('0x21')][_0x3bbc('0x27')],'description':_0x3bbc('0x22')+_0x59bc3f[_0x3bbc('0xc')][_0x3bbc('0x20')]+'\x27'};_0x59bc3f[_0x3bbc('0x17')][_0x3bbc('0x0')]=_0x42c71c;_0x20a672();})['catch'](_0x27fd29=>{_0x20a672(_0x1ae3b0[_0x3bbc('0x14')][_0x3bbc('0x15')](_0x27fd29));})[_0x3bbc('0x11')](()=>{_0x1ae3b0['log'](_0x1ae3b0[_0x3bbc('0xf')][_0x3bbc('0x17')](_0x3bbc('0x2b'),_0x59bc3f[_0x3bbc('0x17')]),_0x3bbc('0x18'));});}};exports[_0x3bbc('0x2d')]={'name':_0x3bbc('0x2d'),'description':_0x3bbc('0x2e'),'blockedConnectionTypes':[_0x3bbc('0x1b')],'version':1.5,'modelSchema':null,'inputs':{'routineId':{'required':!![],'validator':'api.validators.routineId'}},'outputExample':{},'tags':[_0x3bbc('0x9')],'run':function(_0x266c65,_0x1b30c2,_0x36ff6f){_0x266c65[_0x3bbc('0x1e')][_0x3bbc('0x1f')](_0x1b30c2['params'][_0x3bbc('0x20')])[_0x3bbc('0x11')](_0x22b808=>{if(!_0x22b808)throw{'code':_0x266c65[_0x3bbc('0x14')][_0x3bbc('0x21')][_0x3bbc('0x27')],'description':_0x3bbc('0x22')+_0x1b30c2[_0x3bbc('0xc')][_0x3bbc('0x20')]+'\x27'};var _0x577055=_0x22b808[_0x3bbc('0x24')][_0x3bbc('0x2f')](_0x2affcc=>{return new Promise((_0xbbf9de,_0xb2421e)=>{let _0x1b82f3={};_0x266c65[_0x3bbc('0x30')]['retrieveById'](_0x2affcc[_0x3bbc('0x31')]['id'])[_0x3bbc('0x11')](_0xce8240=>{if(!_0xce8240)throw{'code':_0x266c65[_0x3bbc('0x14')]['codes'][_0x3bbc('0x27')],'description':_0x3bbc('0x32')+_0x2affcc['device']['id']+'\x27'};_0x1b82f3[_0x3bbc('0x31')]=_0xce8240;return _0x266c65[_0x3bbc('0x33')][_0x3bbc('0x1f')](_0xce8240[_0x3bbc('0x34')]['id']);})[_0x3bbc('0x11')](_0x3052e3=>{var _0x29dceb=_0x3052e3[_0x3bbc('0x24')][_0x3bbc('0x35')](_0x29dceb=>{return _0x29dceb[_0x3bbc('0x23')]==_0x2affcc[_0x3bbc('0x36')];});if(!_0x29dceb)throw{'code':_0x266c65[_0x3bbc('0x14')][_0x3bbc('0x21')][_0x3bbc('0x27')],'description':_0x3bbc('0x37')+_0x2affcc[_0x3bbc('0x36')]+_0x3bbc('0x38')+_0x1b82f3[_0x3bbc('0x31')]['id']+'\x27'};_0x1b82f3[_0x3bbc('0x36')]=_0x29dceb[_0x3bbc('0x23')];if(_0x29dceb['params'][_0x3bbc('0x39')]!=_0x2affcc[_0x3bbc('0xc')]['length'])throw{'code':_0x266c65[_0x3bbc('0x14')][_0x3bbc('0x21')][_0x3bbc('0x27')],'description':_0x3bbc('0x3a')+_0x2affcc[_0x3bbc('0xc')][_0x3bbc('0x39')]+_0x3bbc('0x3b')+_0x2affcc['actionName']+'\x27'};_0x1b82f3[_0x3bbc('0x3c')]=new _0x266c65[(_0x3bbc('0x30'))][_0x3052e3[(_0x3bbc('0x23'))]](_0x1b82f3['device']['id'],_0x1b82f3[_0x3bbc('0x31')][_0x3bbc('0x3d')]);_0x1b82f3['result']=![];switch(_0x2affcc[_0x3bbc('0xc')][_0x3bbc('0x39')]){case 0x0:return _0x1b82f3[_0x3bbc('0x3c')][_0x2affcc[_0x3bbc('0x36')]]();case 0x1:return _0x1b82f3[_0x3bbc('0x3c')][_0x2affcc[_0x3bbc('0x36')]](_0x1b82f3[_0x3bbc('0xc')][0x0]);case 0x2:return _0x1b82f3['instance'][_0x2affcc[_0x3bbc('0x36')]](_0x1b82f3[_0x3bbc('0xc')][0x0],_0x1b82f3[_0x3bbc('0xc')][0x1]);}})[_0x3bbc('0x11')](_0x3c89a6=>{_0x1b82f3[_0x3bbc('0x12')]=_0x3c89a6;_0x1b82f3[_0x3bbc('0x31')][_0x3bbc('0x3d')]=_0x1b82f3[_0x3bbc('0x3c')][_0x3bbc('0x3e')]();return _0x266c65[_0x3bbc('0x30')]['update'](_0x1b82f3['device']);})[_0x3bbc('0x11')](_0x1922e5=>{var _0x440bc3=new _0x266c65['models']['deviceLog'](new Date()[_0x3bbc('0x3f')](),_0x1b82f3['device']['id'],_0x1b82f3[_0x3bbc('0x36')],_0x1b82f3[_0x3bbc('0xc')],_0x1b82f3['result']);return _0x266c65['deviceLogs'][_0x3bbc('0x40')](_0x440bc3);})[_0x3bbc('0x11')](_0x25f7cd=>{_0xbbf9de(_0x1b82f3[_0x3bbc('0x12')]);})[_0x3bbc('0x13')](_0x180937=>{_0xb2421e(_0x180937);});});});return Promise[_0x3bbc('0x41')](_0x577055);})[_0x3bbc('0x11')](_0x444401=>{var _0x43dee5=_0x444401[_0x3bbc('0x42')](_0x1fad40=>{return _0x1fad40 instanceof Error;});if(_0x43dee5[_0x3bbc('0x39')]>0x0){var _0x265473=[];_0x43dee5[_0x3bbc('0x43')](_0x304d59=>{_0x266c65[_0x3bbc('0xe')](_0x304d59[_0x3bbc('0x44')],_0x3bbc('0x45'));_0x265473[_0x3bbc('0x46')](_0x304d59[_0x3bbc('0x44')]);});_0x36ff6f(_0x266c65[_0x3bbc('0x14')]['handle']({'code':_0x266c65[_0x3bbc('0x14')][_0x3bbc('0x21')]['constraint'],'description':_0x265473}));}else{_0x1b30c2[_0x3bbc('0x17')][_0x3bbc('0x12')]=_0x444401;_0x36ff6f();}})[_0x3bbc('0x13')](_0x451422=>{_0x36ff6f(_0x266c65['errors']['handle'](_0x451422));})['then'](()=>{_0x266c65[_0x3bbc('0xe')](_0x266c65[_0x3bbc('0xf')]['response'](_0x3bbc('0x2d'),_0x1b30c2['response']),_0x3bbc('0x18'));});}};